%Tyler Matthews
%System Simulation Project


%{
dx/dt = y 
dy/dt = -x
%}

%{
dx/dt = y 
dy/dt = (1 - x2 - y2)y - x
%}

clc; close all; clear all; %clear console, clear workspace, close figures

for j = 1:3

    startTime = 0;
    stopTime = stopTimeArr(j);
    steps = 20000;

    T = (stopTime - startTime)/50;
    t = linspace(startTime, stopTime, steps);


    x = zeros(1, length(t));
    y = zeros(1, length(t));
    fx = zeros(1, length(t));
    fy  = zeros(1, length(t));

    x(1) = 1;
    y(1) = 1;

    fx(1) = y(1);
    fy(1) = y(1)*(1 - x(1)^2 - y(1)^2);

    x(2) = x(1) + T*fx(1);
    y(2) = y(1) + T*fy(1);

    for k=3 : steps
        fx(k-1) =  y(k-2);
        fy(k-1) = -x(k-2);
        x(k) = x(k-1) + (3*T)./(2)*fx(k-1) - (T/2)*fx(k-2);
        y(k) = y(k-1) + (3*T)./(2)*fy(k-1) - (T/2)*fy(k-2);
    end

    %PLOTTING
    subplot(3,1,j)
    t1 = sprintf("T = %0.2f", T);
    plot(x, y)
    xlabel('X')
    ylabel('Y')
    title(t1)
end


%{
stopTimeArr = [1, 5, 10];

figure;
for j = 1:3

    startTime = 0;
    stopTime = stopTimeArr(j);
    steps = 20000;

    T = (stopTime - startTime)/50;
    t = linspace(startTime, stopTime, steps);


    x = zeros(1, length(t));
    y = zeros(1, length(t));
    fx = zeros(1, length(t));
    fy  = zeros(1, length(t));

    x(1) = 20;
    y(1) = 10;

    fx(1) = y(1);
    fy(1) = -x(1);

    x(2) = x(1) + T*fx(1);
    y(2) = y(1) + T*fy(1);

    for k=3 : steps
        fx(k-1) =  y(k-2);
        fy(k-1) = -x(k-2);
        x(k) = x(k-1) + (3*T)./(2)*fx(k-1) - (T/2)*fx(k-2);
        y(k) = y(k-1) + (3*T)./(2)*fy(k-1) - (T/2)*fy(k-2);
    end

    %PLOTTING
    subplot(3,1,j)
    t1 = sprintf("T = %0.2f", T);
    plot(x, y)
    xlabel('X')
    ylabel('Y')
    title(t1)
end

initialConditionXArr = [1, 72, 38]
initialConditionYArr = [1, 185, 17]

for j = 1:3

    startTime = 0;
    stopTime = 1;
    steps = 10000;

    T = (stopTime - startTime)/50;
    t = linspace(startTime, stopTime, steps);


    x = zeros(1, length(t));
    y = zeros(1, length(t));
    fx = zeros(1, length(t));
    fy  = zeros(1, length(t));

    x(1) = initialConditionXArr(j);
    y(1) = initialConditionYArr(j);

    fx(1) = y(1);
    fy(1) = -x(1);

    x(2) = x(1) + T*fx(1);
    y(2) = y(1) + T*fy(1);

    for k=3 : steps
        fx(k-1) =  y(k-2);
        fy(k-1) = -x(k-2);
        x(k) = x(k-1) + (3*T)./(2)*fx(k-1) - (T/2)*fx(k-2);
        y(k) = y(k-1) + (3*T)./(2)*fy(k-1) - (T/2)*fy(k-2);
    end

    %PLOTTING
    figure;
    subplot(2,1,1)
    t1 = sprintf("X(1) = %i, Y(1) = %i", x(1), y(1));
    plot(x, y)
    xlabel('X')
    ylabel('Y')
    title(t1)
    
    subplot(2,1,2)
    hold on;
    plot(t,x)
    plot(t,y)
    legend('X', 'Y')
    xlabel('t')
    ylabel('X')
    title(t1)
    

end
%}